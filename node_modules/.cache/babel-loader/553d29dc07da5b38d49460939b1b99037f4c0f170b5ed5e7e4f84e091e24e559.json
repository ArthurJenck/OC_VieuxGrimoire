{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{API_ROUTES,APP_ROUTES}from'../../utils/constants';import{useUser}from'../../lib/customHooks';import{storeInLocalStorage}from'../../lib/common';import{ReactComponent as Logo}from'../../images/Logo.svg';import styles from'./SignIn.module.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function SignIn(_ref){let{setUser}=_ref;const navigate=useNavigate();const{user,authenticated}=useUser();if(user||authenticated){navigate(APP_ROUTES.DASHBOARD);}const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[isLoading,setIsLoading]=useState(false);const[notification,setNotification]=useState({error:false,message:''});const signIn=async()=>{try{var _response$data;setIsLoading(true);const response=await axios({method:'post',url:API_ROUTES.SIGN_IN,data:{email,password}});if(!(response!==null&&response!==void 0&&(_response$data=response.data)!==null&&_response$data!==void 0&&_response$data.token)){setNotification({error:true,message:'Une erreur est survenue'});console.log('Something went wrong during signing in: ',response);}else{storeInLocalStorage(response.data.token,response.data.userId);setUser(response.data);navigate('/');}}catch(err){console.log(err);setNotification({error:true,message:err.message});console.log('Some error occured during signing in: ',err);}finally{setIsLoading(false);}};const signUp=async()=>{try{setIsLoading(true);const response=await axios({method:'POST',url:API_ROUTES.SIGN_UP,data:{email,password}});if(!(response!==null&&response!==void 0&&response.data)){console.log('Something went wrong during signing up: ',response);return;}setNotification({error:false,message:'Votre compte a bien été créé, vous pouvez vous connecter'});}catch(err){setNotification({error:true,message:err.message});console.log('Some error occured during signing up: ',err);}finally{setIsLoading(false);}};const errorClass=notification.error?styles.Error:null;return/*#__PURE__*/_jsxs(\"div\",{className:`${styles.SignIn} container`,children:[/*#__PURE__*/_jsx(Logo,{}),/*#__PURE__*/_jsx(\"div\",{className:`${styles.Notification} ${errorClass}`,children:notification.message.length>0&&/*#__PURE__*/_jsx(\"p\",{children:notification.message})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.Form,children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:email,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Adresse email\"}),/*#__PURE__*/_jsx(\"input\",{className:\"\",type:\"text\",name:\"email\",id:\"email\",value:email,onChange:e=>{setEmail(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"password\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Mot de passe\"}),/*#__PURE__*/_jsx(\"input\",{className:\"border-2 outline-none p-2 rounded-md\",type:\"password\",name:\"password\",id:\"password\",value:password,onChange:e=>{setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.Submit,children:[/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"\\r flex justify-center\\r p-2 rounded-md w-1/2 self-center\\r bg-gray-800  text-white hover:bg-gray-800\",onClick:signIn,children:[isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"\"}):null,/*#__PURE__*/_jsx(\"span\",{children:\"Se connecter\"})]}),/*#__PURE__*/_jsx(\"span\",{children:\"OU\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"\\r flex justify-center\\r p-2 rounded-md w-1/2 self-center\\r bg-gray-800  text-white hover:bg-gray-800\",onClick:signUp,children:[isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"mr-2 w-5 h-5 border-l-2 rounded-full animate-spin\"}):null,/*#__PURE__*/_jsx(\"span\",{children:'S\\'inscrire'})]})]})]})]});}export default SignIn;","map":{"version":3,"names":["React","useState","axios","useNavigate","API_ROUTES","APP_ROUTES","useUser","storeInLocalStorage","ReactComponent","Logo","styles","jsx","_jsx","jsxs","_jsxs","SignIn","_ref","setUser","navigate","user","authenticated","DASHBOARD","email","setEmail","password","setPassword","isLoading","setIsLoading","notification","setNotification","error","message","signIn","_response$data","response","method","url","SIGN_IN","data","token","console","log","userId","err","signUp","SIGN_UP","errorClass","Error","className","children","Notification","length","Form","htmlFor","type","name","id","value","onChange","e","target","Submit","onClick"],"sources":["C:/Users/ajenc/OneDrive/Dev/OpenClassrooms/Projet 6 - Back-end/VieuxGrimoire/src/pages/SignIn/SignIn.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport * as PropTypes from 'prop-types';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { API_ROUTES, APP_ROUTES } from '../../utils/constants';\r\nimport { useUser } from '../../lib/customHooks';\r\nimport { storeInLocalStorage } from '../../lib/common';\r\nimport { ReactComponent as Logo } from '../../images/Logo.svg';\r\nimport styles from './SignIn.module.css';\r\n\r\nfunction SignIn({ setUser }) {\r\n  const navigate = useNavigate();\r\n  const { user, authenticated } = useUser();\r\n  if (user || authenticated) {\r\n    navigate(APP_ROUTES.DASHBOARD);\r\n  }\r\n\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [notification, setNotification] = useState({ error: false, message: '' });\r\n  const signIn = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await axios({\r\n        method: 'post',\r\n        url: API_ROUTES.SIGN_IN,\r\n        data: {\r\n          email,\r\n          password,\r\n        },\r\n      });\r\n      if (!response?.data?.token) {\r\n        setNotification({ error: true, message: 'Une erreur est survenue' });\r\n        console.log('Something went wrong during signing in: ', response);\r\n      } else {\r\n        storeInLocalStorage(response.data.token, response.data.userId);\r\n        setUser(response.data);\r\n        navigate('/');\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n      setNotification({ error: true, message: err.message });\r\n      console.log('Some error occured during signing in: ', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const signUp = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await axios({\r\n        method: 'POST',\r\n        url: API_ROUTES.SIGN_UP,\r\n        data: {\r\n          email,\r\n          password,\r\n        },\r\n      });\r\n      if (!response?.data) {\r\n        console.log('Something went wrong during signing up: ', response);\r\n        return;\r\n      }\r\n      setNotification({ error: false, message: 'Votre compte a bien été créé, vous pouvez vous connecter' });\r\n    } catch (err) {\r\n      setNotification({ error: true, message: err.message });\r\n      console.log('Some error occured during signing up: ', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n  const errorClass = notification.error ? styles.Error : null;\r\n  return (\r\n    <div className={`${styles.SignIn} container`}>\r\n      <Logo />\r\n      <div className={`${styles.Notification} ${errorClass}`}>\r\n        {notification.message.length > 0 && <p>{notification.message}</p>}\r\n      </div>\r\n      <div className={styles.Form}>\r\n        <label htmlFor={email}>\r\n          <p>Adresse email</p>\r\n          <input\r\n            className=\"\"\r\n            type=\"text\"\r\n            name=\"email\"\r\n            id=\"email\"\r\n            value={email}\r\n            onChange={(e) => { setEmail(e.target.value); }}\r\n          />\r\n        </label>\r\n        <label htmlFor=\"password\">\r\n          <p>Mot de passe</p>\r\n          <input\r\n            className=\"border-2 outline-none p-2 rounded-md\"\r\n            type=\"password\"\r\n            name=\"password\"\r\n            id=\"password\"\r\n            value={password}\r\n            onChange={(e) => { setPassword(e.target.value); }}\r\n          />\r\n        </label>\r\n        <div className={styles.Submit}>\r\n          <button\r\n            type=\"submit\"\r\n            className=\"\r\n            flex justify-center\r\n            p-2 rounded-md w-1/2 self-center\r\n            bg-gray-800  text-white hover:bg-gray-800\"\r\n            onClick={signIn}\r\n          >\r\n            {isLoading ? <div className=\"\" /> : null}\r\n            <span>\r\n              Se connecter\r\n            </span>\r\n          </button>\r\n          <span>OU</span>\r\n          <button\r\n            type=\"submit\"\r\n            className=\"\r\n            flex justify-center\r\n            p-2 rounded-md w-1/2 self-center\r\n            bg-gray-800  text-white hover:bg-gray-800\"\r\n            onClick={signUp}\r\n          >\r\n            {\r\n                isLoading\r\n                  ? <div className=\"mr-2 w-5 h-5 border-l-2 rounded-full animate-spin\" /> : null\r\n              }\r\n            <span>\r\n              {'S\\'inscrire'}\r\n            </span>\r\n          </button>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nSignIn.propTypes = {\r\n  setUser: PropTypes.func.isRequired,\r\n};\r\nexport default SignIn;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}